---
lab:
  title: استخراج البيانات من النماذج
  module: Module 6 - Document Intelligence
---

# استخراج البيانات من النماذج

نفترض أن الشركة تتطلب حاليًا من الموظفين شراء أوراق الطلبات يدويًا وإدخال البيانات في قاعدة البيانات. يريدون منك استخدام خدمات الذكاء الاصطناعي لتحسين عملية إدخال البيانات. قررت إنشاء نموذج تعلُّم آلي يقرأ النموذج وينتج بيانات منظمة يمكن استخدامها لتحديث قاعدة البيانات تلقائيًا.

تُعدَّ **Azure AI Document Intelligence** خدمة الذكاء الاصطناعي في Azure التي تُمكِّن المستخدمين من إنشاء برامج معالجة البيانات الآلية. يمكن لهذا البرنامج استخراج النصوص وأزواج المفاتيح/القيم والجداول من مستندات النماذج باستخدام التعرُّف البصري على الحروف (OCR). يحتوي Azure AI Document Intelligence على نماذج جاهزة مسبقًا للتعرُّف على الفواتير والإيصالات وبطاقات العمل. وتوفر الخدمة أيضًا القدرة على تدريب النماذج المخصَّصة. في هذا التمرين، سنركز على تصميم نماذج مخصَّصة.

## الاستعداد لتطوير تطبيق في تعليمة Visual Studio البرمجية

الآن دعونا نستخدم SDK للخدمة لتطوير تطبيق باستخدام تعليمة Visual Studio البرمجية. تم توفير ملفات التعليمات البرمجية للتطبيق الخاص بك في مستودع GitHub.

> **تلميح**: إذا كنت قد قمت بالفعل باستنساخ مستودع **mslearn-ai-document-intelligence**، فافتحه في تعليمة Visual Studio البرمجية. بخلاف ذلك، اتبع الخطوات التالية لاستنساخه إلى بيئة التطوير الخاصة بك.

1. ابدأ تشغيل Visual Studio Code.
1. افتح لوحة (SHIFT+CTRL+P) وشغّل **Git: استنسخ الأمر ** لاستنساخ مستودع `https://github.com/MicrosoftLearning/mslearn-ai-document-intelligence` إلى مجلد محلي (لا يُهم أي مجلد).
1. عند استنساخ المستودع، افتح المجلد في Visual Studio Code.

    > **ملاحظة**: إذا عرضت لك Visual Studio Code رسالة منبثقة لمطالبتك بالثقة في التعليمات البرمجية التي تفتحها، فانقر فوق **نعم، أثق في خيار الكُتاب** في النافذة المنبثقة.

1. انتظر حتى تثبيت ملفات إضافية لدعم مشاريع التعليمات البرمجية C# في المستودع.

    > **ملاحظة**: إذا جرت مطالبتك بإضافة الأصول المطلوبة للبناء وتصحيح الأخطاء، فحدد **ليس الآن**. إذا تمت مطالبتك برسالة *اكتشاف مشروع وظيفة Azure في المجلد*، يمكنك إغلاق هذه الرسالة بأمان.

## إنشاء مورد Azure AI Document Intelligence

لاستخدام خدمة Azure AI Document Intelligence، تحتاج إلى مورد Azure AI Document Intelligence أو Azure AI Services في اشتراك Azure الخاص بك. ستستخدم مدخل Microsoft Azure لإنشاء مورد.

1. في علامة تبويب المستعرض، افتح مدخل Microsoft Azure على `https://portal.azure.com`، وقم بتسجيل الدخول باستخدام حساب Microsoft المرتبط باشتراكك في Azure.
1. في الصفحة الرئيسية لمدخل Microsoft Azure، انتقل إلى مربع البحث العلوي واكتب **Document Intelligence**، ثم اضغط على **إدخال**.
1. في صفحة **Document Intelligence**، حدد **إنشاء**.
1. في صفحة **إنشاء استخبارات المستندات**، استخدم ما يلي لتكوين الموارد الخاصة بك:
    - **Subscription**: حدد اشتراك Azure الخاص بك.
    - **مجموعة الموارد**: حدد أو أنشئ مجموعة موارد باسم فريد مثل *DocIntelligenceResources*.
    - **المنطقة**: حدد منطقة قريبة منك.
    - **الاسم**: أدخل اسمًا فريدًا عالميًا.
    - **مستوى الأسعار**: حدد **Free F0** (إذا لم يكن لديك مستوى مجاني متوفر، فحدد **Standard S0**).
1. ثم حدد ⁧⁧**⁩⁩⁩⁩مراجعة + إنشاء⁦⁦**⁩⁩ و**إنشاء**. انتظر بينما يقوم Azure بإنشاء مورد Azure AI Document Intelligence.
1. عند اكتمال النشر، حدد **الانتقال إلى المورد** لعرض صفحة **نظرة عامة** الخاصة بالمورد. 

## جمع المستندات للتدريب

ستستخدم نماذج العينة مثل هذا النموذج لتدريب نموذج اختبار: 

![صورة الفاتورة المستخدمة في هذا المشروع.](../media/Form_1.jpg)

1. ارجع إلى **تعليمة Visual Studio البرمجية**. في جزء *المستكشف*، افتح المجلد **Labfiles/02-custom-document-intelligence** وقم بتوسيع المجلد **sample-forms**. لاحظ أن هناك ملفات تنتهي بـ **.json** و **.jpg** في المجلد.

    ستستخدم ملفات **.jpg** لتدريب نموذجك.  

    لقد تم إنشاء ملفات **.json** لك وهي تحتوي على معلومات التسمية. سيتم تحميل الملفات إلى حاوية تخزين الكائنات الثنائية كبيرة الحجم الخاصة بك إلى جانب النماذج.

    يمكنك عرض الصور التي نستخدمها في مجلد *sample-forms* عن طريق تحديدها في تعليمة Visual Studio البرمجية.

1. ارجع إلى **مدخل Microsoft Azure** وانتقِل إلى صفحة **نظرة عامة** في موردك إذا لم تكن هناك بالفعل. ضمن قسم *الأساسيات*، اعرض **مجموعة الموارد** التي قمت بإنشاء مورد Document Intelligence فيها.

1. في صفحة **النظرة العامة** لمجموعة الموارد الخاصة بك، لاحظ **معرف الاشتراك** و**الموقع**. ستحتاج إلى هذه القيم، إلى جانب اسم **مجموعة الموارد** في الخطوات اللاحقة.

    ![مثال على صفحة مجموعة الموارد.](../media/resource_group_variables.png)

1. في تعليمة Visual Studio البرمجية  في جزء *المستكشف*، انتقِل إلى المجلد **Labfiles/02-custom-document-intelligence** وقم بتوسيع المجلد **CSharp** أو **Python** حسب تفضيل اللغة لديك. يحتوي كل مجلد على الملفات الخاصة باللغة للتطبيق الذي تريد دمج وظيفة Azure OpenAI فيه.

1. انقر بزر الماوس الأيمن فوق المجلد **CSharp** أو **Python** الذي يحتوي على ملفات التعليمات البرمجية الخاصة بك وحدد **فتح محطة طرفية متكاملة**. 

1. في الوحدة الطرفية، شغَّل الأمر التالي لتسجيل الدخول إلى Azure. سيؤدي الأمر **az login** إلى فتح متصفح Microsoft Edge، وتسجيل الدخول بنفس الحساب الذي استخدمته لإنشاء مورد Azure AI Document Intelligence. بمجرد تسجيل الدخول، أغلق نافذة المتصفح.

    ```powershell
    az login
    ```

1. عد إلى Visual Studio Code. في جزء الوحدة الطرفية، شغَّل الأمر التالي لسرد مواقع Azure.

    ```powershell
    az account list-locations -o table
    ```

1. في المخرجات، ابحث عن قيمة **الاسم** التي تتوافق مع موقع مجموعة الموارد الخاصة بك (على سبيل المثال، بالنسبة *لشرق الولايات المتحدة*، الاسم المقابل هو *eastus*).

    > **مهم**: قم بتسجيل قيمة **الاسم** واستخدمها في الخطوة 11.

1. في تعليمة Visual Studio البرمجية  في المجلد **Labfiles/02-custom-document-intelligence**، حدد **setup.cmd**. ستستخدم هذا البرنامج النصي لتشغيل أوامر واجهة سطر أوامر Azure (CLI) المطلوبة لإنشاء موارد Azure الأخرى التي تحتاجها.

1. في البرنامج النصي **setup.cmd**، راجع الأوامر. سيقوم البرنامج بما يلي:
    - إنشاء حساب تخزين في مجموعة موارد Azure الخاصة بك
    - تحميل الملفات من مجلد *sampleforms* المحلي الخاص بك إلى حاوية تسمى *sampleforms* في حساب التخزين
    - طباعة معرف URI لـ Shared Access Signature

1. قم بتعديل إعلانات المتغيرات **subscription_id**، و**resource_group**، و**location** بالقيم المناسبة للاشتراك ومجموعة الموارد واسم الموقع الذي قمت بنشر مورد Document Intelligence فيه.
ثم **احفظ** التغييرات.

    اترك متغير **expiry_date** كما هو بالنسبة للتمرين. يتم استخدام هذا المتغير عند إنشاء معرف URI لـ Shared Access Signature (SAS). في الممارسة العملية، قد ترغب في تحديد تاريخ انتهاء صلاحية مناسب لـ SAS الخاص بك. يمكنك معرفة المزيد عن SAS [هنا](https://docs.microsoft.com/azure/storage/common/storage-sas-overview#how-a-shared-access-signature-works).  

1. في الوحدة الطرفية لمجلد **Labfiles/02-custom-document-intelligence**، أدخل الأمر التالي لتشغيل البرنامج النصي:

    ```PowerShell
    ./setup.cmd
    ```

1. عند اكتمال البرنامج النصي، قم بمراجعة المخرجات المعروضة.

1. في مدخل Microsoft Azure، قم بتحديث مجموعة الموارد الخاصة بك وتأكد من أنها تحتوي على حساب Azure Storage الذي تم إنشاؤه للتو. افتح حساب التخزين، وفي الجزء الموجود على اليسار، حدد **متصفح التخزين**. بعد ذلك في متصفح التخزين، قم بتوسيع **حاويات الكائنات الثنائية كبيرة الحجم** وحدد حاوية **sampleforms** للتحقق من تحميل الملفات من المجلد المحلي **02-custom-document-intelligence/sample-forms**.

## تدريب النموذج باستخدام Document Intelligence Studio

سنقوم الآن بتدريب النموذج باستخدام الملفات التي قمت بتحميلها إلى حساب التخزين.

1. في المتصفح، انتقل إلى Document Intelligence Studio في `https://documentintelligence.ai.azure.com/studio`.
1. مرِّر لأسفل إلى قسم **النماذج المخصَّصة** وحدد تجانب **نموذج الاستخراج المخصَّص**.
1. إذا طلب منك تسجيل الدخول إلى حسابك، فاستخدم بيانات اعتماد Azure.
1. إذا تم سؤالك عن مورد Azure AI Document Intelligence الذي يجب استخدامه، فحدد الاشتراك واسم المورد اللذين استخدمتهما عند إنشاء مورد Azure AI Document Intelligence.
1. ضمن **مشاريعي**، حدد **إنشاء مشروع**. استخدم التكوينات التالية:

    - **اسم المشروع**: أدخل اسمًا فريدًا.
        - حدد *متابعة*.
    - **تكوين مورد الخدمة**: حدد الاشتراك ومجموعة الموارد ومورد document intelligence الذي قمت بإنشائه مسبقًا في هذا الواجب. ضع علامة على المربع *تعيين كإعداد افتراضي*. الاحتفاظ بإصدار API الافتراضي. 
        - حدد *متابعة*.
    - **ربط مصدر بيانات التدريب**: حدد الاشتراك ومجموعة الموارد وحساب التخزين الذي تم إنشاؤه بواسطة البرنامج النصي للإعداد. ضع علامة على المربع *تعيين كإعداد افتراضي*. حدد حاوية الكائن الثنائي كبير الحجم `sampleforms`، واترك مسار المجلد فارغًا.
        - حدد *متابعة*.
    - اختر * إنشاء مشروع *

1. بمجرد إنشاء مشروعك، في الجزء العلوي الأيسر من الشاشة، حدد **تدريب** لتدريب النموذج الخاص بك. استخدم التكوينات التالية:
    - **معرف النموذج**: *وفِّر اسمًا فريدًا عالميًا (ستحتاج إلى اسم معرف النموذج في الخطوة التالية)*. 
    - **وضع الإصدار**: القالب.
1. حدد **الانتقال إلى النماذج**.
1. قد يستغرق التدريب بعض الوقت. سترى إشعارًا عند اكتماله.

## اختبار نموذج Document Intelligence المخصَّص الخاص بك

1. عد إلى Visual Studio Code. في الوحدة الطرفية، قم بتثبيت حزمة Document Intelligence عن طريق تشغيل الأمر المناسب لتفضيل اللغة الخاص بك:

    **C#:**

    ```powershell
    dotnet add package Azure.AI.FormRecognizer --version 4.1.0
    ```

    **Python**:

    ```powershell
    pip install azure-ai-formrecognizer==3.3.3
    ```

1. في تعليمة Visual Studio البرمجية في المجلد **Labfiles/02-custom-document-intelligence**، حدد اللغة التي تستخدمها. قم بتعديل ملف التكوين (**appsettings.json** أو **.env**، حسب تفضيل اللغة لديك) بالقيم التالية:
    - نقطة نهاية Document Intelligence الخاصة بك.
    - مفتاح Document Intelligence الخاص بك.
    - معرف النموذج الذي تم إنشاؤه قمت بتوفيره عند تدريب النموذج الخاص بك. يمكنك العثور على هذا في صفحة **النماذج** في Document Intelligence Studio. **احفظ** تغييراتك.

1. في تعليمة Visual Studio البرمجية، افتح ملف التعليمة البرمجية لتطبيق العميل الخاص بك (*Program.cs* لـ C#، و*test-model.py* لـ Python) واستعرض التعليمة البرمجية التي تحتوي عليه، وخاصة أن الصورة الموجودة في عنوان URL تشير إلى الملف الموجود في مستودع GitHub هذا على الويب.

1. قم بإعادة الوحدة الطرفية، وأدخل الأمر التالي لتشغيل البرنامج:

    **C#**

    ```powershell
    dotnet build
    dotnet run
    ```

    **Python**

    ```powershell
    python test-model.py
    ```

1. قم بعرض المخرجات ولاحظ كيف يوفر مخرج النموذج أسماء الحقول مثل `Merchant` و`CompanyPhoneNumber`.

## تنظيف

إذا انتهيت من استخدام مورد Azure، فتذكر حذف المورد في [مدخل Microsoft Azure](https://portal.azure.com/?azure-portal=true) لتجنب المزيد من الرسوم.

## مزيد من المعلومات

لمزيد من المعلومات حول خدمة Document Intelligence، راجع [مستندات Document Intelligence](https://learn.microsoft.com/azure/ai-services/document-intelligence/?azure-portal=true).
