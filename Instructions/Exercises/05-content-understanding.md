---
lab:
  title: تحليل المحتوى باستخدام Azure AI Content Understanding
  module: Multimodal analysis with Content Understanding
---

# تحليل المحتوى باستخدام Azure AI Content Understanding

في هذا التدريب، يمكنك استخدام مدخل مصنع الذكاء الاصطناعي في Azure لإنشاء مشروع فهم المحتوى الذي يمكنه استخراج المعلومات من الفواتير. ثم ستختبر محلل محتواك في مدخل Azure AI Foundry وتستخدمه من خلال واجهة Content Understanding REST.

سيستغرق هذا التدريب حوالي **30** دقيقة.

## إنشاء مشروع في مصنع الذكاء الاصطناعي في Azure

دعنا نبدأ بإنشاء مشروع في مصنع الذكاء الاصطناعي في Azure.

1. في متصفح الويب، افتح [مدخل Azure AI Foundry](https://ai.azure.com) على `https://ai.azure.com` وسجّل الدخول باستخدام بيانات اعتماد Azure الخاصة بك. أغلق أية تلميحات أو أجزاء تشغيل سريع يتم فتحها عندما تقوم بتسجيل الدخول، وإذا لزم الأمر، استخدم شعار **مصنع الذكاء الاصطناعي في Azure** في أعلى اليسار للانتقال إلى الصفحة الرئيسية، والتي تبدو مشابهة للصورة التالية:

    ![لقطة شاشة لمدخل Azure AI Foundry.](../media/ai-foundry-portal.png)

1. في الصفحة الرئيسية، حدد **+ إنشاء مشروع**.
1. في معالج** إنشاء مشروع**، أدخل اسمًا مناسبًا لمشروعك، وإذا تم اقتراح مركزًا موجودًا، فحدد خيار إنشاء مركز جديد. ثم راجع موارد Azure التي سيتم إنشاؤها تلقائيًا لدعم مركزك ومشروعك.
1. حدد **تخصيص** وحدد الإعدادات التالية لمركزك:
    - **اسم المركز**: *اسم صالح لمركزك*
    - **Subscription**: *اشتراكك في Azure*
    - **Resource group**: *إنشاء مجموعة موارد أو تحديدها*
    - **الموقع**: حدد إحدى المناطق التالية\*
        - غرب الولايات المتحدة
        - منطقة السويد الوسطى
        - شرق أستراليا
    - **الاتصال بخدمات Azure AI أو Azure OpenAI**: *إنشاء مزود جديد لخدمات الذكاء الاصطناعي*
    - **ربط Azure AI Search**: *أنشئ مورد Azure AI Search جديد باسم فريد*

    > \*في وقت كتابة هذا التقرير، يكون فهم محتوى الذكاء الاصطناعي في Azure غير قابل للتقديم إلا في هذه المناطق.

1. حدد **التالي** لمراجعة التكوين الخاص بك. ثم حدد **إنشاء** وانتظر حتى تكتمل العملية.
1. عند إنشاء مشروعك، أغلق أي تلميحات يتم عرضها وراجع صفحة المشروع في مدخل مصنع الذكاء الاصطناعي في Azure، والذي يجب أن يبدو مشابهة للصورة التالية:

    ![لقطة شاشة توضح تفاصيل مشروع ذكاء اصطناعي في Azure في مدخل مصنع الذكاء الاصطناعي في Azure.](../media/ai-foundry-project.png)

## إنشاء محلل "فهم المحتوى"

ستقوم ببناء محلل يمكنه استخراج المعلومات من الفواتير. ستبدأ بتحديد مخطط استنادًا إلى عينة فاتورة.

1. في علامة تبويب متصفح جديدة، قم بتنزيل نموذج العينة [invoice-1234.pdf](https://github.com/microsoftlearning/mslearn-ai-document-intelligence/raw/main/Labfiles/05-content-understanding/forms/invoice-1234.pdf) من `https://github.com/microsoftlearning/mslearn-ai-document-intelligence/raw/main/Labfiles/05-content-understanding/forms/invoice-1234.pdf` واحفظه في مجلد محلي.
1. ارجع إلى علامة التبويب التي تحتوي على الصفحة الرئيسية لمشروع مصنع الذكاء الاصطناعي في Azure؛ وفي جزء التنقل على اليسار، حدد **فهم المحتوى**.
1. في صفحة **فهم المحتوى**، حدد علامة التبويب **محلل مخصص** في الأعلى.
1. في صفحة محلل فهم المحتوى المخصص، حدد **+ إنشاء**، وأنشئ مهمة بالإعدادات التالية:
    - **اسم المهمة**: تحليل الفاتورة
    - **الوصف**: استخراج البيانات من فاتورة
    - **اتصال خدمات الذكاء الاصطناعي في Azure**: *مورد خدمات الذكاء الاصطناعي في Azure في مركز مصنع الذكاء الاصطناعي في Azure*
    - **حساب تخزين كائن Azure الثنائي كبير الحجم**:*حساب التخزين الافتراضي في مركز مصنع الذكاء الاصطناعي في Azure*
1. انتظر حتى يتم إنشاء المهمة.

    > **تلميح**: إذا حدث خطأ في الوصول إلى التخزين، فانتظر دقيقة وحاول مرة أخرى.

1. في صفحة **تعريف المخطط**، قم بتحميل ملف **invoice-1234.pdf** الذي قمت بتنزيله للتو.
1. حدد قالب **تحليل الفاتورة**، ثم حدد **إنشاء**.

    يتضمن *تحليل الفاتورة* الحقول الشائعة الموجودة في الفواتير. يمكنك استخدام محرر المخطط لحذف أي من الحقول المقترحة التي لا تحتاج إليها، وإضافة أي حقول مخصصة تقوم باستخدامها.

1. في قائمة الحقول المقترحة، حدد **BillingAddress**. هذا الحقل غير مطلوب لتنسيق الفاتورة الذي قمت بتحميله، لذا استخدم أيقونة **حذف الحقل** (**&#128465;**) التي تظهر لحذفها.
1. الآن احذف الحقول المقترحة التالية، والتي ليست مطلوبة:
    - عنوان المرسل إليه الفاتورة
    - عنوان مراسلة العميل
    - Customerid
    - CustomerTaxId
    - DueDate
    - إجمالي الفاتورة
    - PaymentTerm
    - الرصيد السابق غير المدفوع
    - PurchaseOrder
    - عنوان التحويلات
    - عنوان متلقي التحويلات
    - ServiceAddress
    - عنوان متلقي الخدمة
    - ShippingAddress
    - عنوان مراسلة الشحن
    - TotalDiscount
    - عنوان مراسلة البائع
    - VendorTaxId
    - TaxDetails
1. استخدم زر **+ إضافة حقل جديد** لإضافة الحقول التالية:

    | اسم الحقل | وصف الحقل | نوع القيمة | الأسلوب |
    |--|--|--|--|
    | `VendorPhone` | `Vendor telephone number` | السلسلة‬ | الاستخراج |
    | `ShippingFee` | `Fee for shipping` | الرقم‬ | الاستخراج |

1. تحقق من أن المخطط المكتمل يبدو كما يلي، ثم حدد **حفظ**.
    ![لقطة شاشة لمخطط لفاتورة.](../media/invoice-schema.png)

1. في صفحة **محلل الاختبار**، إذا لم يبدأ التحليل تلقائيًا، فحدد **تشغيل التحليل**. ثم انتظر حتى اكتمال التحليل وراجع قيم النص في الفاتورة التي تم تحديدها على أنها تطابق الحقول في المخطط.
1. راجع نتائج التحليل، والتي يجب أن تبدو مشابهة لهذا:

    ![لقطة شاشة لنتائج اختبار المحلل.](../media/analysis-results.png)

1. اعرض تفاصيل الحقول التي تم تعريفها في جزء **الحقول**، ثم اعرض علامة تبويب **النتيجة** لمشاهدة تمثيل JSON.

## إنشاء محلل واختباره

الآن بعد أن درّبت نموذج لاستخراج الحقول من فواتيرك، يمكنك إنشاء مُحلل لاستخدامه مع نماذج مماثلة.

1. حدد صفحة **إنشاء محلل**، ثم حدد **+ إنشاء مُحلل** وأنشئ مُحللًا جديدًا بالخصائص التالية (مكتوب بالضبط كما هو موضح هنا):
    - **الاسم:** `contoso-invoice-analyzer`
    - **الوصف**: `Contoso invoice analyzer`
1. انتظر حتى يصبح المحلل الجديد جاهزًا (استخدم زر **تحديث** للتحقق).
1. قم بتنزيل نموذج [invoice-1235.pdf](https://github.com/microsoftlearning/mslearn-ai-document-intelligence/raw/main/Labfiles/05-content-understanding/forms/invoice-1235.pdf) من `https://github.com/microsoftlearning/mslearn-ai-document-intelligence/raw/main/Labfiles/05-content-understanding/forms/invoice-1235.pdf` واحفظه في مجلد محلي.
1. ارجع إلى صفحة **إنشاء محلل** وحدد رابط **contoso-invoice-analyzer**. سيتم عرض الحقول المحددة في مخطط المحلل.
1. في صفحة **contoso-invoice-analyzer**، حدد علامة تبويب **اختبار**.
1. استخدم الزر **+ تحميل ملفات الاختبار** لتحميل **invoice-1235.pdf** وتشغيل التحليل لاستخراج بيانات الحقل من نموذج الاختبار.
1. راجع نتائج الاختبار، وتحقق من أن المُحلل استخرج الحقول الصحيحة من فاتورة الاختبار.
1. أغلق صفحة **contoso-invoice-analyzer***.

## استخدم واجهة برمجة تطبيقات Content Understanding REST

الآن بعد أن قمت بإنشاء محلل، يمكنك استخدامه من خلال تطبيق عميل عبر واجهة برمجة تطبيقات Content Understanding REST.

1. في منطقة **تفاصيل المشروع**، لاحظ **سلسلة الاتصال للمشروع**. ستستخدم سلسلة الاتصال هذه للاتصال بمشروعك في تطبيق العميل.
1. افتح علامة تبويب جديدة للمتصفح (مع إبقاء مدخل مصنع الذكاء الاصطناعي في Azure مفتوحًا في علامة التبويب الموجودة). بعد ذلك في علامة التبويب الجديدة، انتقل إلى [بوابة Azure](https://portal.azure.com) على `https://portal.azure.com`؛ وسجّل الدخول باستخدام بيانات اعتماد Azure الخاصة بك إذا طُلب منك ذلك.

    أغلق أي إشعارات ترحيبية لرؤية الصفحة الرئيسية لبوابة Azure.

1. استخدم الزر **[\>_]** الموجود على يمين شريط البحث أعلى الصفحة لإنشاء Cloud Shell جديد في بوابة Azure، وتحديد بيئة ***PowerShell*** بدون مساحة تخزين في اشتراكك.

    يوفّر Cloud Shell واجهة سطر الأوامر في الجزء الموجود في أسفل بوابة Azure. يمكنك تغيير حجم هذا الجزء أو تكبيره لتسهيل العمل فيه.

    > **ملاحظة**: إذا كنت قد أنشأت مسبقًا Cloud Shell يستخدم بيئة *معالج Bash*، فبدّل إلى ***PowerShell***.

1. في شريط أدوات Cloud Shell، في قائمة **الإعدادات**، حدد **الانتقال إلى الإصدار الكلاسيكي** (هذا مطلوب لاستخدام محرر التعليمات البرمجية).

    **<font color="red">تأكد من التبديل إلى الإصدار الكلاسيكي من cloud shell قبل المتابعة.</font>**

1. في جزء Cloud Shell، أدخل الأوامر التالية لاستنساخ مستودع GitHub الذي يحتوي على ملفات التعليمات البرمجية لهذا التمرين (اكتب الأمر أو انسخه إلى الحافظة ثم انقر بزر الماوس الأيمن في سطر الأوامر وقم بلصقه كنص عادي):

    ```
   rm -r mslearn-ai-foundry -f
   git clone https://github.com/microsoftlearning/mslearn-ai-document-intelligence mslearn-ai-doc
    ```

    > **تلميح**: أثناء إدخال الأوامر في CloudShell، قد يشغل الإخراج كمية كبيرة من مساحة المخزن المؤقت للشاشة. يمكنك مسح الشاشة عن طريق إدخال الأمر `cls` لتسهيل التركيز على كل مهمة.

1. بعد استنساخ مخزن البيانات الخاصة، انتقل إلى المجلد الذي يحتوي على ملفات التعليمات البرمجية لتطبيقك:

    ```
   cd mslearn-ai-doc/Labfiles/05-content-understanding/code
   ls -a -l
    ```

1. في جزء سطر الأوامر Cloud Shell، أدخل الأمر التالي لتثبيت المكتبات التي ستستخدمها:

    ```
   python -m venv labenv
   ./labenv/bin/Activate.ps1
   pip install dotenv azure-identity azure-ai-projects
    ```

1. أدخل الأمر التالي لتحرير ملف التكوين الذي تم توفيره:

    ```
   code .env
    ```

    يتم فتح الملف في محرر التعليمات البرمجية.

1. في ملف التعليمات البرمجية، استبدل العنصر النائب **YOUR_PROJECT_CONNECTION_STRING** بسلسلة الاتصال لمشروعك (تم نسخه من صفحة **نظرة عامة** على المشروع في مدخل مصنع الذكاء الاصطناعي في Azure)، وتأكد من تعيين **ANALYZER** إلى الاسم الذي عينته إلى مُحللك (والذي يجب أن يكون *contoso-invoice-analyzer*)
1. بعد استبدال العناصر النائبة في محرر التعليمات البرمجية، استخدم الأمر **CTRL+S** لحفظ التغييرات ثم استخدم الأمر **CTRL+Q** لإغلاق محرر التعليمات البرمجية مع إبقاء سطر أوامر Cloud Shell مفتوحًا.

1. في سطر أوامر cloud shell، أدخل الأمر التالي لتحرير ملف التعليمات البرمجية **analyze_doc.py** لـ Python الذي تم توفيره:

    ```
    code analyze_invoice.py
    ```
    يتم فتح ملف التعليمات البرمجية Python في محرر التعليمات البرمجية:

1. راجع التعليمات البرمجية، والتي:
    - تحدد ملف الفاتورة المراد تحليله، مع التعيين الافتراضي لـ **invoice-1236.pdf**.
    - تسترد نقطة النهاية والمفتاح لمورد خدمات الذكاء الاصطناعي في Azure من المشروع.
    - jرسل طلب HTTP POST إلى نقطة نهاية فهم المحتوى لديك، ويطلب منها تحليل الصورة.
    - يتحقق من الاستجابة لعملية POST لاسترداد مُعرّف لعملية التحليل.
    - ترسل طلب HTTP GET بشكل متكرر إلى خدمة Content Understanding حتى تتوقف العملية عن التشغيل.
    - إذا نجح التشغيل، يتم تحليل استجابة JSON وعرض القيم المستردة
1. استخدم الأمر **CTRL+Q** لإغلاق محرر التعليمات البرمجية مع إبقاء سطر أوامر Cloud Shell مفتوحًا.
1. في جزء سطر أوامر ِCloud Shell، أدخل الأمر التالي لتشغيل تعليمة Python البرمجية:

    ```
    python analyze_invoice.py invoice-1236.pdf
    ```

1. مراجعة الناتج من البرنامج
1. استخدم الأمر التالي لتشغيل البرنامج بفاتورة مختلفة:

    ```
    python analyze_invoice.py invoice-1235.pdf
    ```

    > **تلميح**: هناك ثلاثة ملفات فاتورة في مجلد التعليمات البرمجية يمكنك استخدامها (invoice-1234.pdf، وinvoice-1235.pdf، وinvoice-1236.pdf) 

## تنظيف

إذا انتهيت من العمل باستخدام خدمة "فهم المحتوى"، فيجب عليك حذف الموارد التي قمت بإنشائها في هذا التمرين لتجنب تكبد تكاليف Azure غير الضرورية.

1. في مدخل Azure AI Foundry، انتقل إلى مشروع **تأمين-السفر** واحذفه.
1. في بوابة Azure، انتقل إلى مجموعة الموارد التي أنشأتها لهذه التدريبات.

